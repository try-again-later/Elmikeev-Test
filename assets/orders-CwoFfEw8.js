import{d as y,u as B,a as D,V as N,b as P}from"./VTable-D4GppN64.js";import{u as T,a as R,V as b,b as U}from"./useNProgress-DuS1JfmL.js";import{aA as E,w as V,i as L,aB as S,aC as c,aD as p,h as e,c as s,aH as $,aI as F,aE as r,aJ as g,aK as n,Y as A,aL as Q,aG as Y,F as v,aF as j,aj as o}from"./index-TiV2RsM6.js";function q(d){const t=new URL("https://elmikeev.185-236-23-37.sslip.io/api/orders");return t.searchParams.append("dateFrom",y(d.dateFrom)),t.searchParams.append("dateTo",y(d.dateTo)),t.searchParams.append("page",d.page.toString()),t.searchParams.append("limit",d.limit.toString()),t.searchParams.append("key","E6kUTYrYwZq2tN4QEtyzsbEBk3ie"),t}const z={class:"text-center"},J=E({__name:"orders",setup(d){const{dateFrom:t,dateTo:i}=T(),u=B("page","1",{transform:Number});V(t,()=>{u.value=1}),V(i,()=>{u.value=1});const k=L(()=>q({dateFrom:t.value??new Date,dateTo:i.value??new Date,page:u.value,limit:100}).href),{execute:w,isFetching:x,error:h,data:f}=D(k,{refetch:!0}).get().json(),{isLoading:C}=R();return V(x,m=>{C.value=m}),(m,a)=>{const _=S("v-date-input");return p(),c(v,null,[a[6]||(a[6]=e("h1",{class:"mb-8"},"Заказы",-1)),s(U,null,{default:r(()=>[s(b,{cols:"12",sm:"6"},{default:r(()=>[s(_,{label:"Начиная с даты",modelValue:n(t),"onUpdate:modelValue":a[0]||(a[0]=l=>g(t)?t.value=l:null)},null,8,["modelValue"])]),_:1}),s(b,{cols:"12",sm:"6"},{default:r(()=>[s(_,{label:"Заканчивая датой",modelValue:n(i),"onUpdate:modelValue":a[1]||(a[1]=l=>g(i)?i.value=l:null)},null,8,["modelValue"])]),_:1})]),_:1}),n(h)!=null?(p(),$(Y,{key:0,class:"d-flex flex-column ga-4 align-center"},{default:r(()=>[a[4]||(a[4]=e("p",null,"Ошибка при загрузке данных",-1)),s(A,{onClick:n(w)},{default:r(()=>a[3]||(a[3]=[Q("Попробовать ещё раз")])),_:1,__:[3]},8,["onClick"])]),_:1,__:[4]})):F("",!0),n(f)!=null&&n(h)==null?(p(),c(v,{key:1},[s(N,{"fixed-header":"",striped:"even"},{default:r(()=>[a[5]||(a[5]=e("thead",null,[e("tr",null,[e("th",null,"Штрих-код"),e("th",null,"Дата"),e("th",null,"Полная сумма"),e("th",null,"Скидка"),e("th",null,"Отменён"),e("th",null,"Регион"),e("th",null,"Склад")])],-1)),e("tbody",null,[(p(!0),c(v,null,j(n(f).data,l=>(p(),c("tr",null,[e("td",null,o(l.barcode),1),e("td",null,o(l.date),1),e("td",null,o(parseFloat(l.total_price).toFixed(2)),1),e("td",null,o(`${l.discount_percent}%`),1),e("td",null,o(l.is_cancel?"Да":"Нет"),1),e("td",null,o(l.oblast),1),e("td",null,o(l.warehouse_name),1)]))),256))])]),_:1,__:[5]}),e("div",z,[s(P,{modelValue:n(u),"onUpdate:modelValue":a[2]||(a[2]=l=>g(u)?u.value=l:null),length:n(f).meta.last_page,density:m.$vuetify.display.smAndDown?"compact":"default","total-visible":m.$vuetify.display.smAndDown?2:5},null,8,["modelValue","length","density","total-visible"])])],64)):F("",!0)],64)}}});export{J as default};
