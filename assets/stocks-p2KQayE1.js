import{d as k,u as b,a as U,V as y,P as F,b as D,c as x,e as E}from"./VTable-B_20iPVk.js";import{u as N}from"./stockFilters-DX_oIGiw.js";import{s as A}from"./startOfDay-gdqdGqv8.js";import{V as T}from"./VSelect-Dv-_GBPS.js";import{a1 as B,q as m,I as Q,a3 as _,a4 as g,h as t,c as n,a9 as q,a5 as r,ab as v,_ as w,a6 as L,af as u,ac as $}from"./index-CuxgLMCI.js";import"./VList-CgXDfau6.js";function I(o){return A(Date.now(),o)}function O(o){const s=new URL("https://elmikeev.185-236-23-37.sslip.io/api/stocks");return s.searchParams.append("dateFrom",k(o.dateFrom)),s.searchParams.append("dateTo",k(o.dateTo)),s.searchParams.append("page",o.page.toString()),s.searchParams.append("limit",o.limit.toString()),s.searchParams.append("key","E6kUTYrYwZq2tN4QEtyzsbEBk3ie"),s}const Y={class:"text-center"},K=B({__name:"stocks",setup(o){const s=N(),p=b("page","1",{transform:Number}),P=m(()=>O({dateFrom:I(),dateTo:new Date,page:p.value,limit:100}).href),{error:W,data:h}=U(P,{refetch:!0}).get().json(),V=b("in-way-to-client","Не важно"),i=m({get(){return V.value},set(e){V.value=e}}),C=b("in-way-from-client","Не важно"),d=m({get(){return C.value},set(e){C.value=e}});Q(()=>{s.page=p.value,s.inWayFromClient=d.value,s.inWayToClient=i.value});const f=m(()=>h.value==null?[]:h.value.data.filter(e=>{let a=!0;return i.value!="Не важно"&&a&&(a=i.value=="Да"&&e.in_way_to_client||i.value=="Нет"&&!e.in_way_to_client),d.value!="Не важно"&&a&&(a=d.value=="Да"&&e.in_way_from_client||d.value=="Нет"&&!e.in_way_from_client),a})),R=m(()=>{const e=[0,0];return e[0]=f.value.reduce((a,c)=>a+(c.in_way_to_client?1:0),0),e[1]=f.value.length-e[0],e}),S=m(()=>{const e=[0,0];return e[0]=f.value.reduce((a,c)=>a+(c.in_way_from_client?1:0),0),e[1]=f.value.length-e[0],e});return(e,a)=>{var c;return g(),_(w,null,[a[4]||(a[4]=t("h1",{class:"mb-8"},"Склады",-1)),n(D,null,{default:r(()=>[n(y,{cols:"12",sm:"6",class:"position-relative",height:"500"},{default:r(()=>[n(v(F),{data:{labels:["Да","Нет"],datasets:[{label:"В пути к клиенту",data:R.value,backgroundColor:["rgb(255, 99, 132)","rgb(54, 162, 235)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:"В пути к клиенту"}}}},null,8,["data"])]),_:1}),n(y,{cols:"12",sm:"6",class:"position-relative",height:"500"},{default:r(()=>[n(v(F),{data:{labels:["Да","Нет"],datasets:[{label:"В пути от клиента",data:S.value,backgroundColor:["rgb(255, 99, 132)","rgb(54, 162, 235)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:"В пути от клиента"}}}},null,8,["data"])]),_:1})]),_:1}),n(D,null,{default:r(()=>[n(y,{cols:"12",sm:"6"},{default:r(()=>[n(T,{label:"В пути к клиенту",modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=l=>i.value=l),items:["Да","Нет","Не важно"]},null,8,["modelValue"])]),_:1}),n(y,{cols:"12",sm:"6"},{default:r(()=>[n(T,{label:"В пути от клиента",modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=l=>d.value=l),items:["Да","Нет","Не важно"]},null,8,["modelValue"])]),_:1})]),_:1}),v(W)==null?(g(),_(w,{key:0},[n(x,{"fixed-header":"",striped:"even",class:"mt-8"},{default:r(()=>[a[3]||(a[3]=t("thead",null,[t("tr",null,[t("th",null,"Артикул"),t("th",null,"Штрих-код"),t("th",null,"Дата"),t("th",null,"Склад"),t("th",null,"Стоимость"),t("th",null,"В пути к клиенту"),t("th",null,"В пути от клиента")])],-1)),t("tbody",null,[(g(!0),_(w,null,L(f.value,l=>(g(),_("tr",null,[t("td",null,u(l.nm_id),1),t("td",null,u(l.barcode),1),t("td",null,u(l.date),1),t("td",null,u(l.warehouse_name),1),t("td",null,u(l.price??0),1),t("td",null,u(l.in_way_to_client?"Да":"Нет"),1),t("td",null,u(l.in_way_from_client?"Да":"Нет"),1)]))),256))])]),_:1,__:[3]}),t("div",Y,[n(E,{modelValue:v(p),"onUpdate:modelValue":a[2]||(a[2]=l=>$(p)?p.value=l:null),length:(c=v(h))==null?void 0:c.meta.last_page,density:e.$vuetify.display.smAndDown?"compact":"default","total-visible":e.$vuetify.display.smAndDown?2:5},null,8,["modelValue","length","density","total-visible"])])],64)):q("",!0)],64)}}});export{K as default};
