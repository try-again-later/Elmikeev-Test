import{d as _,u as B,a as D,V as N,b as P}from"./VTable-DXErF1X9.js";import{u as T,a as R,V as b,b as U}from"./useNProgress-DQnkOuM9.js";import{aA as E,w as V,i as L,aB as S,aC as f,aD as i,h as e,c as s,aH as q,aI as k,aE as u,aJ as g,aK as n,Y as A,aL as Q,aG as Y,F as v,aF as $,aj as m}from"./index-DIO7pRL5.js";function j(r){const l=new URL("https://elmikeev.185-236-23-37.sslip.io/api/incomes");return l.searchParams.append("dateFrom",_(r.dateFrom)),l.searchParams.append("dateTo",_(r.dateTo)),l.searchParams.append("page",r.page.toString()),l.searchParams.append("limit",r.limit.toString()),l.searchParams.append("key","E6kUTYrYwZq2tN4QEtyzsbEBk3ie"),l}const z={class:"text-center"},J=E({__name:"incomes",setup(r){const{dateFrom:l,dateTo:d}=T(),o=B("page","1",{transform:Number});V(l,()=>{o.value=1}),V(d,()=>{o.value=1});const w=L(()=>j({dateFrom:l.value??new Date,dateTo:d.value??new Date,page:o.value,limit:100}).href),{execute:F,isFetching:C,error:y,data:c}=D(w,{refetch:!0}).get().json(),{isLoading:x}=R();return V(C,p=>{x.value=p}),(p,a)=>{const h=S("v-date-input");return i(),f(v,null,[a[6]||(a[6]=e("h1",{class:"mb-8"},"Доходы",-1)),s(U,null,{default:u(()=>[s(b,{cols:"12",sm:"6"},{default:u(()=>[s(h,{label:"Начиная с даты",modelValue:n(l),"onUpdate:modelValue":a[0]||(a[0]=t=>g(l)?l.value=t:null)},null,8,["modelValue"])]),_:1}),s(b,{cols:"12",sm:"6"},{default:u(()=>[s(h,{label:"Заканчивая датой",modelValue:n(d),"onUpdate:modelValue":a[1]||(a[1]=t=>g(d)?d.value=t:null)},null,8,["modelValue"])]),_:1})]),_:1}),n(y)!=null?(i(),q(Y,{key:0,class:"d-flex flex-column ga-4 align-center"},{default:u(()=>[a[4]||(a[4]=e("p",null,"Ошибка при загрузке данных",-1)),s(A,{onClick:n(F)},{default:u(()=>a[3]||(a[3]=[Q("Попробовать ещё раз")])),_:1,__:[3]},8,["onClick"])]),_:1,__:[4]})):k("",!0),n(c)!=null&&n(y)==null?(i(),f(v,{key:1},[s(N,{"fixed-header":"",striped:"even"},{default:u(()=>[a[5]||(a[5]=e("thead",null,[e("tr",null,[e("th",null,"Штрих-код"),e("th",null,"Дата"),e("th",null,"Дата закрытия"),e("th",null,"Количество"),e("th",null,"Склад")])],-1)),e("tbody",null,[(i(!0),f(v,null,$(n(c).data,t=>(i(),f("tr",null,[e("td",null,m(t.barcode),1),e("td",null,m(t.date),1),e("td",null,m(t.date_close),1),e("td",null,m(t.quantity),1),e("td",null,m(t.warehouse_name),1)]))),256))])]),_:1,__:[5]}),e("div",z,[s(P,{modelValue:n(o),"onUpdate:modelValue":a[2]||(a[2]=t=>g(o)?o.value=t:null),length:n(c).meta.last_page,density:p.$vuetify.display.smAndDown?"compact":"default","total-visible":p.$vuetify.display.smAndDown?2:5},null,8,["modelValue","length","density","total-visible"])])],64)):k("",!0)],64)}}});export{J as default};
