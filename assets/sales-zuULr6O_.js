import{d as y,u as D,a as B,V as N,b as P}from"./VTable-DXErF1X9.js";import{u as T,a as R,V as F,b as U}from"./useNProgress-DQnkOuM9.js";import{aA as E,w as g,i as L,aB as S,aC as f,aD as p,h as e,c as s,aH as $,aI as b,aE as r,aJ as V,aK as n,Y as A,aL as Q,aG as Y,F as v,aF as j,aj as u}from"./index-DIO7pRL5.js";function q(d){const t=new URL("https://elmikeev.185-236-23-37.sslip.io/api/sales");return t.searchParams.append("dateFrom",y(d.dateFrom)),t.searchParams.append("dateTo",y(d.dateTo)),t.searchParams.append("page",d.page.toString()),t.searchParams.append("limit",d.limit.toString()),t.searchParams.append("key","E6kUTYrYwZq2tN4QEtyzsbEBk3ie"),t}const I={class:"text-center"},J=E({__name:"sales",setup(d){const{dateFrom:t,dateTo:i}=T(),o=D("page","1",{transform:Number});g(t,()=>{o.value=1}),g(i,()=>{o.value=1});const k=L(()=>q({dateFrom:t.value??new Date,dateTo:i.value??new Date,page:o.value,limit:100}).href),{execute:w,isFetching:x,error:_,data:c}=B(k,{refetch:!0}).get().json(),{isLoading:C}=R();return g(x,m=>{C.value=m}),(m,a)=>{const h=S("v-date-input");return p(),f(v,null,[a[6]||(a[6]=e("h1",{class:"mb-8"},"Продажи",-1)),s(U,null,{default:r(()=>[s(F,{cols:"12",sm:"6"},{default:r(()=>[s(h,{label:"Начиная с даты",modelValue:n(t),"onUpdate:modelValue":a[0]||(a[0]=l=>V(t)?t.value=l:null)},null,8,["modelValue"])]),_:1}),s(F,{cols:"12",sm:"6"},{default:r(()=>[s(h,{label:"Заканчивая датой",modelValue:n(i),"onUpdate:modelValue":a[1]||(a[1]=l=>V(i)?i.value=l:null)},null,8,["modelValue"])]),_:1})]),_:1}),n(_)!=null?(p(),$(Y,{key:0,class:"d-flex flex-column ga-4 align-center"},{default:r(()=>[a[4]||(a[4]=e("p",null,"Ошибка при загрузке данных",-1)),s(A,{onClick:n(w)},{default:r(()=>a[3]||(a[3]=[Q("Попробовать ещё раз")])),_:1,__:[3]},8,["onClick"])]),_:1,__:[4]})):b("",!0),n(c)!=null&&n(_)==null?(p(),f(v,{key:1},[s(N,{"fixed-header":"",striped:"even"},{default:r(()=>[a[5]||(a[5]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Штрих-код"),e("th",null,"Дата"),e("th",null,"Полная сумма"),e("th",null,"Скидка"),e("th",null,"Регион"),e("th",null,"Склад")])],-1)),e("tbody",null,[(p(!0),f(v,null,j(n(c).data,l=>(p(),f("tr",null,[e("td",null,u(l.sale_id),1),e("td",null,u(l.barcode),1),e("td",null,u(l.date),1),e("td",null,u(parseFloat(l.total_price).toFixed(2)),1),e("td",null,u(`${l.discount_percent}%`),1),e("td",null,u(l.region_name),1),e("td",null,u(l.warehouse_name),1)]))),256))])]),_:1,__:[5]}),e("div",I,[s(P,{modelValue:n(o),"onUpdate:modelValue":a[2]||(a[2]=l=>V(o)?o.value=l:null),length:n(c).meta.last_page,density:m.$vuetify.display.smAndDown?"compact":"default","total-visible":m.$vuetify.display.smAndDown?2:5},null,8,["modelValue","length","density","total-visible"])])],64)):b("",!0)],64)}}});export{J as default};
